galaxy.data
===========

.. py:module:: galaxy.data

.. autoapi-nested-parse::

   Script to get dataloaders



Attributes
----------

.. autoapisummary::

   galaxy.data.TORCHVISION_MEAN
   galaxy.data.TORCHVISION_STD
   galaxy.data.main_transforms
   galaxy.data.required_columns
   galaxy.data.optional_columns


Classes
-------

.. autoapisummary::

   galaxy.data.DataSource
   galaxy.data.DataPart
   galaxy.data.ShiftAndMirrorPadTransform
   galaxy.data.ClusterDataset


Functions
---------

.. autoapisummary::

   galaxy.data.shift_and_mirror_pad
   galaxy.data.download_data
   galaxy.data.inherit_columns
   galaxy.data.read_dr5
   galaxy.data.read_mc
   galaxy.data.read_sga
   galaxy.data.read_tyc2
   galaxy.data.read_gaia
   galaxy.data.get_cluster_catalog
   galaxy.data.filter_candiates
   galaxy.data.generate_candidates_dr5
   galaxy.data.generate_candidates_mc
   galaxy.data.create_negative_class_dr5
   galaxy.data.create_negative_class_mc
   galaxy.data.create_data_train
   galaxy.data.create_data_test
   galaxy.data.train_val_test_split
   galaxy.data.ddos
   galaxy.data.create_dataloaders


Module Contents
---------------

.. py:data:: TORCHVISION_MEAN
   :value: [23.19058950345032, 22.780995295792817]


.. py:data:: TORCHVISION_STD
   :value: [106.89880134344101, 100.32284196853638]


.. py:data:: main_transforms

.. py:class:: DataSource

   Bases: :py:obj:`str`, :py:obj:`enum.Enum`


   str(object='') -> str
   str(bytes_or_buffer[, encoding[, errors]]) -> str

   Create a new string object from the given object. If encoding or
   errors is specified, then the object must expose a data buffer
   that will be decoded using the given encoding and error handler.
   Otherwise, returns the result of object.__str__() (if defined)
   or repr(object).
   encoding defaults to sys.getdefaultencoding().
   errors defaults to 'strict'.


   .. py:attribute:: DR5
      :value: 'dr5'



   .. py:attribute:: MC
      :value: 'mc'



   .. py:attribute:: SGA
      :value: 'sga'



   .. py:attribute:: TYC2
      :value: 'tyc2'



   .. py:attribute:: GAIA
      :value: 'gaia'



.. py:class:: DataPart

   Bases: :py:obj:`str`, :py:obj:`enum.Enum`


   str(object='') -> str
   str(bytes_or_buffer[, encoding[, errors]]) -> str

   Create a new string object from the given object. If encoding or
   errors is specified, then the object must expose a data buffer
   that will be decoded using the given encoding and error handler.
   Otherwise, returns the result of object.__str__() (if defined)
   or repr(object).
   encoding defaults to sys.getdefaultencoding().
   errors defaults to 'strict'.


   .. py:attribute:: TRAIN
      :value: 'train'



   .. py:attribute:: VALIDATE
      :value: 'validate'



   .. py:attribute:: TEST
      :value: 'test'



   .. py:attribute:: MC
      :value: 'mc'



   .. py:attribute:: GAIA
      :value: 'gaia'



.. py:function:: shift_and_mirror_pad(image, shift_x, shift_y)

   Shifts the image by (shift_x, shift_y) and applies mirror-padding.

   Parameters:
   - image (Tensor): Input tensor of shape (C, H, W)
   - shift_x (int): Horizontal shift (positive: right, negative: left)
   - shift_y (int): Vertical shift (positive: down, negative: up)

   Returns:
   - Tensor: Augmented image tensor of shape (C, H, W)


.. py:class:: ShiftAndMirrorPadTransform(max_shift_x: int = 20, max_shift_y: int = 20)

   .. py:attribute:: max_shift_x


   .. py:attribute:: max_shift_y


   .. py:method:: __call__(image)


.. py:class:: ClusterDataset(images_dir_path: str, description_csv_path: str, transform=None)

   Bases: :py:obj:`torch.utils.data.Dataset`


   An abstract class representing a :class:`Dataset`.

   All datasets that represent a map from keys to data samples should subclass
   it. All subclasses should overwrite :meth:`__getitem__`, supporting fetching a
   data sample for a given key. Subclasses could also optionally overwrite
   :meth:`__len__`, which is expected to return the size of the dataset by many
   :class:`~torch.utils.data.Sampler` implementations and the default options
   of :class:`~torch.utils.data.DataLoader`. Subclasses could also
   optionally implement :meth:`__getitems__`, for speedup batched samples
   loading. This method accepts list of indices of samples of batch and returns
   list of samples.

   .. note::
     :class:`~torch.utils.data.DataLoader` by default constructs an index
     sampler that yields integral indices.  To make it work with a map-style
     dataset with non-integral indices/keys, a custom sampler must be provided.


   .. py:attribute:: images_dir_path


   .. py:attribute:: description_df


   .. py:attribute:: transform


   .. py:method:: __len__()


   .. py:method:: __getitem__(idx)


   .. py:method:: _read_img(fits_path: pathlib.Path)
      :staticmethod:



.. py:function:: download_data()

.. py:data:: required_columns

.. py:data:: optional_columns

.. py:function:: inherit_columns(frame: pandas.DataFrame)

.. py:function:: read_dr5()

.. py:function:: read_mc()

.. py:function:: read_sga(sample_size=10000)

.. py:function:: read_tyc2(sample_size=5000)

.. py:function:: read_gaia()

.. py:function:: get_cluster_catalog() -> astropy.coordinates.SkyCoord

.. py:function:: filter_candiates(candidates: astropy.coordinates.SkyCoord, max_len: int) -> astropy.coordinates.SkyCoord

.. py:function:: generate_candidates_dr5() -> astropy.coordinates.SkyCoord

.. py:function:: generate_candidates_mc()

   Create sample from MadCows catalogue


.. py:function:: create_negative_class_dr5()

   Create sample from dr5 clsuter catalogue


.. py:function:: create_negative_class_mc()

.. py:function:: create_data_train()

.. py:function:: create_data_test()

.. py:function:: train_val_test_split()

.. py:function:: ddos()

.. py:function:: create_dataloaders()

